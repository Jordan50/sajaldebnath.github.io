
<!DOCTYPE html>
<html lang="en-US">
<!-- Including the Head tag and metadata -->


<head>
  <!--Meta-->
    <meta charset="UTF-8">
    <title>Oracle Weblogic-as-a-Service for vRealize Automation-Anything Virtual and Cloudy</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=5.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Here you will find posts on various VMware and other technologies including but not limited to vRealize Suite, NSX, VSAN, PowerCLI, Python, and DevOps. A special focus is on vRA, vROps and vRO">
    <meta name="author" content="Sajal Debnath">
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/css/clr-ui.min.css">
    <style>
      .responsive {
        max-width: 100%;
        height: auto;
      }
      .video-container {
        position: relative;
        padding-bottom: 56.25%;
        padding-top: 30px; height: 0; overflow: hidden;
      }
      .video-container iframe,
      .video-container object,
      .video-container embed {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
    </style>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
<!--  <main> body starts from here-->
  <clr-main-container class="main-container">
    <div class="alert alert-app-level alert-warning">
        <div class="alert-items">
            <div class="alert-item static">
                <div class="alert-text">
                    Just moved to Hexo + VMware Clarity combination. This site is not fully working in Firefox. Try IE/Chrome/Safari Browsers instead.
                </div>
            </div>
        </div>
    </div>
    <!-- Blog Header Navigation and Subnav menus -->
    
<!-- <header class="header header-4"> -->

<clr-header class="header-4 header">
  <!---->
  <button class="header-hamburger-trigger" type="button" aria-label="HeaderMenu">
    <span></span>
  </button>
  <div class="branding">
      <a class="logo-and-title" href="/" >
          <span><img SRC="/images/logo.png" ALT="Logo" WIDTH=36 HEIGHT=36></img></span>
          <span class="title">Anything Virtual and Cloudy</span>
      </a>
  </div>
  <div class="divider"></div>
  <ul class="header-nav list-unstyled clr-nav-level-1">
    <li class="nav-item">
      <a href="/" class="nav-link nav-text">Home</a>
    </li>
      <!---->
      <li class="nav-item">
        <a href="/about/" class="nav-link nav-text">About</a>
      </li>
        <!---->
      <li class="nav-item">
        <a href="/contact/" class="nav-link nav-text">Contact</a>
      <li>
      <li class="nav-item">
        <a href="/archives/" class="nav-link nav-text">Archives</a>
      <li>
        <!---->
  </ul>
  <!---->
  <button class="header-overflow-trigger ng-star-inserted" type="button" aria-label="SubnavMenu">
    <span></span>
  </button>
    <div class="header-backdrop"></div>
</clr-header>

    <!-- -->
<nav class="subnav clr-nav-level-2">

    <ul class="nav">
      <li class="nav-item">
        <div class="dropdown">
          <button type="button" class="dropdown-toggle btn btn-sm btn-info-outline" title="Click for Dropdown">
              vRealize Suite
          </button>
          <div class="dropdown-menu">
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/vRealize-Suite/vRealize-Automation">vRealize Automation</a></button>
            <div class="dropdown-divider"></div>
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/vRealize-Suite/vRealize-Operations">vRealize Operations</a></button>
            <div class="dropdown-divider"></div>
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/vRealize-Suite/vRealize-Orchestrator">vRealize Orchestrator</a></button>
            <div class="dropdown-divider"></div>
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/vRealize-Suite/vRealize-Code-Stream">vRealize Code Stream</a></button>
            <div class="dropdown-divider"></div>
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/vRealize-Suite/vRealize-LogInsight">vRealize LogInsight</a></button>
          </div>
        </div>
      </li>
      <li class="nav-item">
        <div class="dropdown">
          <button type="button" class="dropdown-toggle btn btn-sm title="Click for Dropdown" btn-info-outline">
            Scripting
          </button>
          <div class="dropdown-menu">
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/Automation-and-Scripting/PowerCLI">PowerCLI</a></button>
            <div class="dropdown-divider"></div>
            <button type="button" class="dropdown-item"><a class="nav-link" href="/categories/Automation-and-Scripting/Python">Python</a></button>
          </div>
        </div>
      </li>

        <li class="nav-item">
            <a class="nav-link" href="/categories/NSX">NSX</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/categories/DevOps">DevOps</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/categories/VSAN">VSAN</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="/categories/General">General</a>
        </li>
    </ul>
</nav>


    <!-- Content container starts from here-->
    <!-- Dividing the content area into two different part. First part will Show
      Post and Page related information. Right side will have widgets -->
    <div class="content-container">
      <div class="content-area">
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9">
                <div class="card">
     <div class="card-header">
         <h3 class="card-title" >
           Oracle Weblogic-as-a-Service for vRealize Automation
         </h3>
     </div>
     <div class="card-block">
    
     <div class="alert alert-warning">
        <div class="alert-items">
            <div class="alert-item static">
                <div class="alert-text">
                  


Related Categories: <a href="/categories/vRealize-Suite/">#vRealize Suite</a> <a href="/categories/vRealize-Suite/vRealize-Automation/">#vRealize Automation</a> <a href="/categories/vRealize-Suite/vRealize-Orchestrator/">#vRealize Orchestrator</a> &nbsp &nbsp &nbsp &nbsp <img border="0" alt="Info-Standard" src="/calendar-line.svg" width="18" height="18"></img> 2018-02-15



                </div>
            </div>
        </div>
     </div>
     
     <div class="card-text">
     <!-- Content -->
         <h4 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h4><p>Recently I got a request to build a Weblogic-as-a-Service in vRealize Automation for a customer. This post provides details of that custom built Out-of-the-Box Oracle Weblogic-as-a-Service in vRealize Automation.</p>
<a id="more"></a>
<h4 id="Requirement"><a href="#Requirement" class="headerlink" title="Requirement:"></a><strong>Requirement:</strong></h4><p>The requirement is to deploy a Weblogic Cluster as a whole. Also, user should be able to choose any number of nodes in the cluster at runtime. For example, it may be anything within the range 1 to 20, etc.</p>
<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a><strong>Solution:</strong></h4><p>VMware vRealize Automation, vCenter Server and vRealize Orchestrator was used to build the overall solution. Red Hat Linux 7.2 was selected as the base operating system for the Weblogic platform. Provided below are the details of the technologies used:</p>
<ul>
<li>VMware vRealize Automation 7.2 (It should work with other versions as well)</li>
<li>VMware vCenter Server 6.0 U3 (Should work with other versions as well)</li>
<li>VMware vRealize Orchestrator 7.2 (7.x versions should work)</li>
<li>RHEL 7.2</li>
<li>Java 1.8.0_151</li>
<li>Java(TM) SE Runtime Environment (build 1.8.0_151-b12)</li>
<li>Java HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode</li>
<li>Oracle WebLogic Server 12.2.1.3 (Generic)</li>
</ul>
<h4 id="Pre-Requisites"><a href="#Pre-Requisites" class="headerlink" title="Pre-Requisites:"></a>Pre-Requisites:</h4><p>Provided below are the pre-requisites for the solution. There are multiple stages of the solution.</p>
<ol>
<li>A properly installed and configured vRealize Automation should be available</li>
<li>Proper licenses should be available in vRealize Automation</li>
<li>Build out the Template for the solution</li>
</ol>
<p>Provided below are the steps for building out the Template to be used for the solution. </p>
<p><strong>Step-1: Create a VM and install RHEL 7.2 in it. The VM configuration is as given below:</strong></p>
<ul>
<li>16GB RAM</li>
<li>8 GB Swap</li>
<li>4 vCPUs</li>
<li>/weblogic - 50 GB</li>
<li>/weblogs - 50 GB</li>
</ul>
<p>Also, make sure to run the following commands to install required packages in the base image:</p>
<pre class=" language-bash"><code class="language-bash">
yum <span class="token function">install</span> gcc*
yum <span class="token function">install</span> compat-libcap*
yum <span class="token function">install</span> compat-libstdc*
yum <span class="token function">install</span> libaio*
</code></pre>

<p><strong>Step-2: Prepare the RHEL 7.2 VM Template:</strong></p>
<ul>
<li>Install Java on Template VM with below version:<ul>
<li>java version “1.8.0_151”</li>
<li>Java(TM) SE Runtime Environment (build 1.8.0_151-b12)</li>
<li>Java HotSpot(TM) 64-Bit Server VM (build 25.151-b12, mixed mode)</li>
</ul>
</li>
<li>Set <strong>JAVA_HOME</strong> in environment variable.</li>
<li>Download latest Weblogic generic download files from (<a href="http://www.oracle.com/technetwork/middleware/weblogic/downloads/wls-for-dev-1703574.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/middleware/weblogic/downloads/wls-for-dev-1703574.html</a>)</li>
<li>Install sshpass on RHEL 7.2 template</li>
</ul>
<p><strong>Step-3: WebLogic-Common-Environment-Creation</strong> </p>
<p>Run the following commands to build the common environment for Weblogic.</p>
<pre class=" language-bash"><code class="language-bash">
/usr/sbin/groupadd -g 666 wladmin

/usr/sbin/useradd -u 666 -g wladmin -G wladmin wladmin

/usr/bin/echo -e <span class="token string">"<span class="token variable">$Pass1</span>\\n<span class="token variable">$Pass1</span>"</span> <span class="token operator">|</span> <span class="token punctuation">(</span>/usr/bin/passwd --stdin wladmin<span class="token punctuation">)</span>

/usr/bin/mkdir -p /WebLogic/oracle/inventory

/usr/bin/chown -R wladmin:wladmin /WebLogic

/usr/bin/chmod -R 775 /WebLogic

/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/mkdir -p /WebLogic/oracle/middleware"</span>

/usr/bin/java -version

/usr/bin/touch /etc/oraInst.loc

/usr/bin/echo <span class="token string">"inventory_loc=/WebLogic/oracle/inventory"</span> <span class="token operator">></span> /etc/oraInst.loc

/usr/bin/echo <span class="token string">"inst_group=wladmin"</span> <span class="token operator">>></span> /etc/oraInst.loc

/usr/bin/chown wladmin:wladmin /etc/oraInst.loc

/usr/bin/chmod 775 /etc/oraInst.loc

</code></pre>

<p><strong>Step-4: WebLogic-Response-File-Creation</strong> </p>
<p>Run the following commands to create the response file  </p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/cat <span class="token operator">></span> /WebLogic/oracle/Install.rsp <span class="token operator">&lt;&lt;</span> <span class="token string">EOF

[ENGINE]

#DO NOT CHANGE THIS.

Response File Version=1.0.0.0.0

[GENERIC]

#The oracle home location. This can be an existing Oracle Home or a new Oracle Home

ORACLE_HOME=/WebLogic/oracle/middleware


#Set this variable value to the Installation Type selected. e.g. Fusion Middleware Infrastructure, Fusion Middleware Infrastructure With Examples.

INSTALL_TYPE=WebLogic Server

#Provide the My Oracle Support Username. If you wish to ignore Oracle Configuration Manager configuration provide empty string for user name.

MYORACLESUPPORT_USERNAME=

#Provide the My Oracle Support Password

MYORACLESUPPORT_PASSWORD=&lt;secure value="">

#Set this to true if you wish to decline the security updates. Setting this to true and providing empty string for My Oracle Support username will ignore the Oracle Configuration Manager configuration

DECLINE_SECURITY_UPDATES=true

#Set this to true if My Oracle Support Password is specified

SECURITY_UPDATES_VIA_MYORACLESUPPORT=false

#Provide the Proxy Host

PROXY_HOST=

#Provide the Proxy Port

PROXY_PORT=

#Provide the Proxy Username

PROXY_USER=

#Provide the Proxy Password

PROXY_PWD=&lt;secure value="">

#Type String (URL format) Indicates the OCM Repeater URL which should be of the format [scheme[Http/Https]]:/[repeater host]:[repeater port]

COLLECTOR_SUPPORTHUB_URL=

EOF</span>
<span class="token operator">&lt;</span>/secure<span class="token operator">></span><span class="token operator">&lt;</span>/secure<span class="token operator">></span></code></pre>

<pre class=" language-bash"><code class="language-bash">
/usr/bin/echo <span class="token string">"Created the response file"</span>

/usr/bin/chown wladmin:wladmin /WebLogic/oracle/Install.rsp
</code></pre>

<p><strong>Step-5:  WebLogic-Installation-Prerequisite</strong>  </p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/ls -ltr /WebLogic/oracle/middleware

<span class="token function">export</span> WL_HOME<span class="token operator">=</span>/WebLogic/oracle/middleware/wlserver

/usr/bin/cp  /root/fmw\_12.2.1.3.0\_wls.jar /home/wladmin/

/usr/bin/chown wladmin:wladmin  /home/wladmin/fmw\_12.2.1.3.0\_wls.jar

/usr/bin/su  - wladmin -c <span class="token string">"java -jar /home/wladmin/fmw\_12.2.1.3.0\_wls.jar -silent -invPtrLoc

/etc/oraInst.loc -responseFile /WebLogic/oracle/Install.rsp -logfile /WebLogic/oracle/wlsInstall.log"</span>

/usr/bin/ls -ltr /WebLogic/oracle/middleware
</code></pre>

<p><strong>Step-6:  Disable Firewall or open firewall ports</strong> We need to either disable the firewall or open ports in the firewall. For this example, we will disable the firewall in the template.</p>
<pre class=" language-bash"><code class="language-bash">
<span class="token function">service</span> firewalld stop
systemctl disable firewalld
</code></pre>

<p>Once the Template is ready, export and use it in vRealize Automation.</p>
<h4 id="Blueprint-Creation"><a href="#Blueprint-Creation" class="headerlink" title="Blueprint Creation"></a>Blueprint Creation</h4><p>Using the above template create a Blueprint in vRealize Automation (as per your requirement). A sample screenshot is provided below: </p>
<p><img src="/images/2018/02/Blueprint-1.jpg" alt="Blueprint 1" class="responsive"></p>
<p>Blueprint 1</p>
<p>Save the blueprint and follow the process to expose it as a Catalog Item in vRealize Automation. </p>
<p><strong> Please note, while giving entitlement, please provide </strong>“Scale Out (Deployment)”** as an Action Item on the items. </p>
<p><strong>Import the vRO Package:</strong> Download the vRO package from <a href="https://github.com/sajaldebnath/Weblogic-as-a-Service" target="_blank" rel="noopener">GitHub Repository</a>. Next, import the vRO package <strong>“com.vmware.library.weblogic-as-a-service.package”</strong> in vRealize Orchestrator server.</p>
<h4 id="Build-the-Catalog-Item"><a href="#Build-the-Catalog-Item" class="headerlink" title="Build the Catalog Item"></a>Build the Catalog Item</h4><p>Next, build a XaaS catalog item in vRealize Automation. Login to vRA with a user with proper rights to create a XaaS Blueprint. Go to Design à XaaS à XaaS Blueprints. Click on New, in the new window, select “Weblogic-as-a-Service” workflow under the Weblogic-as-a-Service Folder in vRO workflow list. Press next and select all the default values. </p>
<p><img src="/images/2018/02/Blueprint-2.jpg" alt="Image1" class="responsive"></p>
<h4 id="Setting-up-Values-in-vRO"><a href="#Setting-up-Values-in-vRO" class="headerlink" title="Setting up Values in vRO"></a>Setting up Values in vRO</h4><p>We need to set up the following values in <strong>“Weblogic-as-a-Service”</strong> in vRO. </p>
<p><img src="/images/2018/02/Value-List.png" alt="Image2" class="responsive"></p>
<p>Provided below are few screenshots as an example. </p>
<p><img src="/images/2018/02/vRO-Package-Values-1.jpg" alt="Image3" class="responsive"></p>
<p><img src="/images/2018/02/vRO-Package-Values-2.jpg" alt="Image4" class="responsive"></p>
<p><img src="/images/2018/02/vRO-Package-Values-3.jpg" alt="Image5" class="responsive"></p>
<p><img src="/images/2018/02/vRO-Package-Values-4.jpg" alt="Image6" class="responsive"></p>
<h4 id="Requesting-the-Item"><a href="#Requesting-the-Item" class="headerlink" title="Requesting the Item"></a>Requesting the Item</h4><p>Login to the vRealize Automation portal with proper rights. Select the exported Catalog Item and Click on “Request”. </p>
<p><img src="/images/2018/02/Request-1-1.jpg" alt="Image7" class="responsive"></p>
<p>In the next page provide the following details:</p>
<ul>
<li>Enter the number of Cluster Nodes:</li>
<li>Enter the Weblogic User Name:</li>
<li>Enter the Weblogic User Password:</li>
</ul>
<p><img src="/images/2018/02/Request-2-1.jpg" alt="Image8" class="responsive"></p>
<p>Once the request is submitted, it will initiate tasks in vRO which in turn will initiate the following serial tasks in vRA.</p>
<ul>
<li>Deploying an instance of the Weblogic Catalog Item</li>
<li>Scale out the Deployment from above step as per the number of cluster nodes.</li>
<li>Once both the above tasks as finished, rest of the Weblogic installation and configuration will be done in vRO</li>
</ul>
<p>Once all the above is complete, the original Catalog Item request of “Weblogic-as-a-Service” will complete and marked as “Successful”. A typical successful workflow run in vRO looks like following: </p>
<p><img src="/images/2018/02/vRO-workflow-run-1.jpg" alt="Image 9" class="responsive"></p>
<h4 id="Testing-the-Deployment"><a href="#Testing-the-Deployment" class="headerlink" title="Testing the Deployment"></a>Testing the Deployment</h4><p>Once the Request is successful, identify the Admin node with the lowest denominator. For example, if you had chosen a 4-node cluster and the nodes are named as weblogic-1, weblogic-2, weblogic-3 and weblogic-4 then weblogic-1 is the Admin node. Remember, the node with lowest number is always the Admin node as it is deployed first. </p>
<p><img src="/images/2018/02/Admin-Node-1.jpg" alt="Image 10" class="responsive"></p>
<p>Note, the IP of the Admin Node. SSH to the admin node and run the following commands:</p>
<pre class=" language-bash"><code class="language-bash">
<span class="token comment" spellcheck="true"># cd /WebLogic/oracle/middleware/user_projects/domains/base_domain/bin</span>
<span class="token comment" spellcheck="true"># nohup ./startNodeManager.sh &amp;</span>
<span class="token comment" spellcheck="true"># nohup ./startWebLogic.sh &amp;</span>
<span class="token comment" spellcheck="true"># ./startManagedWebLogic.sh MS-01 http://&lt;ip of="" admin="" node="">:7001</span>
<span class="token operator">&lt;</span>/ip<span class="token operator">></span></code></pre>

<p>Note, the last command. MS-01 is the admin node, provide the IP address of Admin node in the URL. After the above open the following URL in a browser: <strong>http://<ip of="" admin="" node="">:7001/console</ip></strong> This will open the Weblogic Console. Login with Weblogic admin user id and password provided at setup time. In my case, the user was <strong>“weblogic”</strong>. </p>
<p><img src="/images/2018/02/Weblogic-Page-1.jpg" alt="Image 11" class="responsive"></p>
<p><img src="/images/2018/02/Weblogic-Page-2.jpg" alt="Image 12" class="responsive"></p>
<h4 id="Workflow-Explanation"><a href="#Workflow-Explanation" class="headerlink" title="Workflow Explanation"></a>Workflow Explanation</h4><p>The vRO workflow is divided into multiple parts.</p>
<ul>
<li>The first part deploys the required number of VM’s in vRA and collects the relevant information about them (IPADDRESS, Hostname etc.)</li>
<li>The Second part runs the scripts inside the Guest Operating system of the nodes to install and configure Weblogic Cluster in the nodes.</li>
</ul>
<p><strong>In the next section, we will elaborate each one of them.</strong> </p>
<p><img src="/images/2018/02/Main-Workflow-First-part.jpg" alt="Image 13" class="responsive"></p>
<ul>
<li>First part of the script requests the deployment in vRA. This first VM is considered the Admin node.</li>
</ul>
<p><img src="/images/2018/02/Workflow-1.png" alt="Image 14" class="responsive"></p>
<ul>
<li>In the next part, depending on the number of nodes, if a single node cluster is selected, then a Single Node Cluster configuration is set.</li>
</ul>
<p><img src="/images/2018/02/Workflow-2.png" alt="Image 15" class="responsive"></p>
<p><strong>The script related to single Node Cluster is provided below:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/su - wladmin -c <span class="token string">"/WebLogic/oracle/middleware/oracle_common/common/bin/wlst.sh"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
readTemplate('/WebLogic/oracle/middleware/wlserver/common/templates/wls/wls.jar')
cd('Servers/AdminServer')
cmo.setListenAddress("<span class="token variable">$HostName01</span>.lab.local")
setOption('ServerStartMode','prod')
set('ListenPort', 7001)
create('AdminServer','SSL')
cd('SSL/AdminServer')
set('Enabled', 'True')
set('ListenPort', 7002)

cd('/')
cd('Security/base_domain/User/weblogic')
cmo.setPassword('<span class="token variable">$weblogicpass</span>')
setOption('ServerStartMode','prod')
setOption('OverwriteDomain', 'true')
writeDomain('/WebLogic/oracle/middleware/user\_projects/domains/base\_domain')
closeTemplate()
exit()

EOF</span>


/usr/bin/echo <span class="token string">"Domain Configured on <span class="token variable">$HostName01</span>.lab.local"</span>

/usr/bin/su - wladmin -c <span class="token string">"/WebLogic/oracle/middleware/oracle_common/common/bin/wlst.sh"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
readDomain('/WebLogic/oracle/middleware/user\_projects/domains/base\_domain')
cd('/')
create('MS-01', 'Server')
cd ('Servers')
cd ('MS-01')
set('ListenPort', 7004)
set('ListenAddress', '<span class="token variable">$HostName01</span>.lab.local')
create('basecluster', 'Cluster')
assign('Server', 'MS-01','Cluster','basecluster')
cd('Cluster/basecluster')
set('ClusterMessagingMode', 'unicast')
set('WeblogicPluginEnabled', 'true')
cd('/')
create('Machine01', 'Machine')

assign('Server', 'MS-01','Machine','Machine01')
cd('Machines/' + 'Machine01/')
create('Machine01', 'NodeManager')
cd('NodeManager/' + 'Machine01')
set('NMType', 'Plain')
set('ListenAddress', '<span class="token variable">$HostName01</span>.lab.local')
set('DebugEnabled', 'false')
updateDomain()
closeDomain()
disconnect()
exit()

EOF</span>


<span class="token function">export</span> DOMAIN\_HOME<span class="token operator">=</span>/WebLogic/oracle/middleware/user\_projects/domains/base_domain
<span class="token function">export</span> WL_HOME<span class="token operator">=</span>/WebLogic/oracle/middleware/wlserver

/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/mkdir -p /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/servers/AdminServer/security"</span>
/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/cat > /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/servers/AdminServer/security/boot.properties"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
username=<span class="token variable">$weblogicuser</span>
password=<span class="token variable">$weblogicpass</span>

EOF</span>


/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/sed -i -e 's/SecureListener=true/SecureListener=false/g' /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/nodemanager/nodemanager.properties"</span>

/usr/bin/su - wladmin -c <span class="token string">"nohup /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/bin/startNodeManager.sh &amp;"</span>

/usr/bin/su - wladmin -c <span class="token string">"nohup /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/bin/startWebLogic.sh &amp;"</span>

/usr/bin/su - wladmin -c <span class="token string">"nohup /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/bin/startManagedWebLogic.sh MS-01"</span>
</code></pre>

<ul>
<li>In the next section we scale out the deployment to match the number of required nodes</li>
</ul>
<p><img src="/images/2018/02/Workflow-3.png" alt="Image 16" class="responsive"></p>
<ul>
<li>Next, we collect the required information regarding the Managed Nodes</li>
</ul>
<p><img src="/images/2018/02/Workflow-4.png" alt="Image 17" class="responsive"></p>
<ul>
<li>Next, we prepare the Admin Node for initial settings</li>
</ul>
<p><img src="/images/2018/02/Workflow-5.jpg" alt="Image 18" class="responsive"></p>
<p><strong>Provided below is the script for Admin Node Setup:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/su - wladmin -c <span class="token string">"/WebLogic/oracle/middleware/oracle_common/common/bin/wlst.sh"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
readTemplate('/WebLogic/oracle/middleware/wlserver/common/templates/wls/wls.jar')
cd('Servers/AdminServer')
cmo.setListenAddress("<span class="token variable">$HostName01</span>.lab.local")
setOption('ServerStartMode','prod')
set('ListenPort', 7001)
create('AdminServer','SSL')
cd('SSL/AdminServer')
set('Enabled', 'True')
set('ListenPort', 7002)
cd('/')
cd('Security/base_domain/User/weblogic')
cmo.setPassword('<span class="token variable">$weblogicpass</span>')
setOption('ServerStartMode','prod')
setOption('OverwriteDomain', 'true')
writeDomain('/WebLogic/oracle/middleware/user\_projects/domains/base\_domain')
closeTemplate()
exit()


EOF</span>

/usr/bin/echo <span class="token string">"Domain Configured on <span class="token variable">$HostName01</span>.lab.local"</span>
/usr/bin/touch /tmp/answers.txt

/usr/bin/cat <span class="token operator">>></span> /tmp/answers.txt <span class="token operator">&lt;&lt;</span> <span class="token string">EOF

readDomain('/WebLogic/oracle/middleware/user\_projects/domains/base\_domain')
cd('/')


create('MS-01', 'Server')
cd('Servers')
cd('MS-01')
set('ListenPort', 7004)
set('ListenAddress', '<span class="token variable">$HostName01</span>.lab.local')

EOF</span>
</code></pre>

<p><strong>Next comes the second major part of the Workflow. In this section, we configure the managed nodes.</strong> </p>
<p><img src="/images/2018/02/Workflow-6.png" alt="Image 19" class="responsive"></p>
<p>In this portion, we are dynamically building an answers.txt file which will have all the inputs for the Weblogic Cluster. This file is dynamic as the number of nodes vary and so does the IPADDRESS and Hostname. Let’s break up and elaborate the parts one by one. </p>
<p><img src="/images/2018/02/Workflow-6-3.png" alt="Image 20" class="responsive"></p>
<p><strong>The script used in answersBuild1 is provided below:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/cat <span class="token operator">>></span> /tmp/answers.txt <span class="token operator">&lt;&lt;</span> <span class="token string">EOF

cd('/')
create('MS-REPLACE', 'Server')
cd('Servers')
cd('MS-REPLACE')
set('ListenPort', 7004)
set('ListenAddress', '<span class="token variable">$HostNameReplace</span>.lab.local')

EOF</span>
</code></pre>

<ul>
<li>Next part has the answersbuild2 script.</li>
</ul>
<p><img src="/images/2018/02/Workflow-6-2.png" alt="Image 21" class="responsive"></p>
<p><strong>The script of answersbuild2:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/cat <span class="token operator">>></span> /tmp/answers.txt <span class="token operator">&lt;&lt;</span> <span class="token string">EOF

cd('/')
create('basecluster', 'Cluster')
assign('Server', 'WEBLOGICSERVERNODES','Cluster','basecluster')
cd('Cluster/basecluster')
set('ClusterMessagingMode', 'unicast')
set('WeblogicPluginEnabled', 'true')
cd('/')
create('Machine01', 'Machine')
assign('Server', 'MS-01','Machine','Machine01')
cd('Machines/' + 'Machine01/')
create('Machine01', 'NodeManager')
cd('NodeManager/' + 'Machine01')
set('NMType', 'Plain')
set('ListenAddress', '<span class="token variable">$HostName01</span>.lab.local')
set('DebugEnabled', 'false')

EOF</span>
</code></pre>
*   Next is answersBuild3 script:

<img src="/images/2018/02/Workflow-6-3.png" alt="Image 22" class="responsive">

**The script for answersBuild3:**

<pre class=" language-bash"><code class="language-bash">
/usr/bin/cat <span class="token operator">>></span> /tmp/answers.txt <span class="token operator">&lt;&lt;</span> <span class="token string">EOF

cd('/')
create('MachineREPLACE', 'Machine')
assign('Server', 'MS-REPLACE','Machine','Machine02')
cd('Machines/' + 'MachineREPLACE/')
create('MachineREPLACE', 'NodeManager')
cd('NodeManager/' + 'MachineREPLACE')
set('NMType', 'Plain')
set('ListenAddress', '<span class="token variable">$HostName02</span>.lab.local')
set('DebugEnabled', 'false')

EOF</span>
</code></pre>

<ul>
<li>Next is answersBuild4. At this stage our answers.txt file is ready. Now we can simply read this file for the inputs to Weblogic Cluster setup.</li>
</ul>
<p><img src="/images/2018/02/Workflow-6-4.png" alt="Image 23" class="responsive"></p>
<p><strong>The script for answersBuild4:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/cat <span class="token operator">>></span> /tmp/answers.txt <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
updateDomain()
closeDomain()
disconnect()
exit()

EOF</span>

<span class="token function">cat</span> /tmp/answers.txt

/usr/bin/su - wladmin -c <span class="token string">"/WebLogic/oracle/middleware/oracle_common/common/bin/wlst.sh &lt; /tmp/answers.txt"</span>


/usr/bin/su - wladmin -c <span class="token string">"/WebLogic/oracle/middleware/oracle\_common/common/bin/pack.sh -managed=true -domain=/WebLogic/oracle/middleware/user\_projects/domains/base\_domain -template=/WebLogic/oracle/middleware/user\_projects/domains/base\_domain-wlsTemplate.jar -template\_name=base_domain"</span>

/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/mkdir -p /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/servers/AdminServer/security"</span>
/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/cat > /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/servers/AdminServer/security/boot.properties"</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF
username=<span class="token variable">$weblogicuser</span>
password=<span class="token variable">$weblogicpass</span>

EOF</span>


/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/sed -i -e 's/SecureListener=true/SecureListener=false/g' /WebLogic/oracle/middleware/user\_projects/domains/base\_domain/nodemanager/nodemanager.properties"</span>
</code></pre>

<ul>
<li>Next, we copy the generated template.jar file to each of the managed nodes</li>
</ul>
<p><img src="/images/2018/02/Workflow-6-5.png" alt="Image 24" class="responsive"></p>
<p><strong>Script for packFileBuildAdminNode:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/su - wladmin -c <span class="token string">"sshpass -p '<span class="token variable">$wladminpass</span>' scp -o StrictHostKeyChecking=no  /WebLogic/oracle/middleware/user\_projects/domains/base\_domain-wlsTemplate.jar  wladmin@<span class="token variable">$HostNameIPAdd</span>:/WebLogic/"</span>

/usr/bin/echo <span class="token string">"<span class="token variable">$HostNameIPAdd</span>  <span class="token variable">$HostName02</span>.lab.local <span class="token variable">$HostName02</span>"</span> <span class="token operator">>></span> /etc/hosts
</code></pre>

<ul>
<li>At the last stage, we login to each of the managed nodes and unpack the template.jar file in each one of them.</li>
</ul>
<p><img src="/images/2018/02/Workflow-6-6.png" alt="Image 24" class="responsive"></p>
<p><strong>Script for unpackManagedNode:</strong></p>
<pre class=" language-bash"><code class="language-bash">
/usr/bin/echo <span class="token string">"<span class="token variable">$HostName1IPAdd</span>  <span class="token variable">$HostName1</span>.lab.local <span class="token variable">$HostName1</span>"</span> <span class="token operator">>></span> /etc/hosts
/usr/bin/echo <span class="token string">"<span class="token variable">$AdminIPAdd</span>  <span class="token variable">$Admin</span>.lab.local <span class="token variable">$Admin</span>"</span> <span class="token operator">>></span> /etc/hosts
/usr/bin/su - wladmin -c <span class="token string">"/usr/bin/mkdir -p  /WebLogic/oracle/middleware/user\_projects/domains/base\_domain"</span>
/usr/bin/su - wladmin -c <span class="token string">"/WebLogic/oracle/middleware/oracle\_common/common/bin/unpack.sh -domain=/WebLogic/oracle/middleware/user\_projects/domains/base\_domain -template=/WebLogic/base\_domain-wlsTemplate.jar"</span>
</code></pre>


<h4 id="Yet-to-Do"><a href="#Yet-to-Do" class="headerlink" title="Yet to Do:"></a>Yet to Do:</h4><p>Currently, the package cannot do the following:</p>
<ul>
<li>Once the VM’s are deployed in vRA and later configuring the Weblogic packages if the workflows fail, the VM’s remain in vRA. The VM’s are not cleared.</li>
<li>As a future option, I plan to add an action item which will let the end user add a number of nodes at a later point in time</li>
</ul>
<h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h4><p>Using the process described in the post you can create Oracle Weblogic-as-a-Service in vRealize Automation environment. As always do let me know if this was helpful to you.</p>

     </div>
     </div>
        <div class="card-footer">
            <b>Share this Post &emsp; </b>

            
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/oracle-weblogic-as-a-service-for-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/007-facebook.png" width="25" height="25"></img>
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/oracle-weblogic-as-a-service-for-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/005-linkedin.png" width="25" height="25"></img>
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/oracle-weblogic-as-a-service-for-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/006-twitter.png" width="25" height="25"></img>
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/oracle-weblogic-as-a-service-for-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/003-google-plus.png" width="25" height="25"></img>
</a>


        </div>
    </div>

<!-- Comments Section -->

<section class="comments">
  <div class="card">
    <div class="card-header">
      <b>Comments</b>
    </div>
    <div class="card-block">
      <div class="card-text">
        
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>


      </div>
    </div>
  </div>
</section>


   <!-- Shows the data for the page or posts -->
          </div>
          <!-- Widgets Area -->
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-3">
            <div>
              <!-- Search Area -->
              <div class="row">
                <div class="col-lg-12">
                  <div class="card">
  <div class="card-header">
    <b>Search the Site</b>
  </div>
  <div class="card-block">
    <div class="card-text">
      <script>
        (function() {
          var cx = '013858032712959220653:01en0zgxnjq';
          var gcse = document.createElement('script');
          gcse.type = 'text/javascript';
          gcse.async = true;
          gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(gcse, s);
        })();
      </script>
      <gcse:search></gcse:search>
    </div>
  </div>
</div>
                </div>
              </div>
              <!-- Socials Area -->
              <div class="row">
                <div class="col-lg-12">
                  <div class="card">
  <div class="card-header">
    <b>Follow me on Social Media</b>
  </div>
  <div class="card-block">
    <div class="card-text">
      <a href="https://www.facebook.com/sajal.debnath" class="nav-link nav-text" target="_blank" rel="noopener" >
          <img border="0" alt="Facebook" src="/007-facebook.png" width="25" height="25"></img>
      </a>
      &emsp;
      <a href="https://twitter.com/sajal_debnath" class="nav-link nav-text" target="_blank" rel="noopener">
          <img border="0" alt="Twitter" src="/006-twitter.png" width="25" height="25"></img>
      </a>
      &emsp;
      <a href="https://in.linkedin.com/in/sajaldebnath" class="nav-link nav-text" target="_blank" rel="noopener">
          <img border="0" alt="LinkedIn" src="/005-linkedin.png" width="25" height="25"></img>
      </a>
      &emsp;
      <a href="https://www.youtube.com/user/vmunix1234" class="nav-link nav-text" target="_blank" rel="noopener">
          <img border="0" alt="Youtube" src="/004-youtube.png" width="25" height="25"></img>
      </a>
      &emsp;
      <a href="https://plus.google.com/+SajalDebnath" class="nav-link nav-text" target="_blank" rel="noopener">
          <img border="0" alt="Goolge+" src="/003-google-plus.png" width="25" height="25"></img>
      </a>
      &emsp;
      <a href="https://github.com/sajaldebnath" class="nav-link nav-text" target="_blank" rel="noopener">
          <img border="0" alt="Github" src="/002-github.png" width="25" height="25"></img>
      </a>
      &emsp;
      <a href="https://sajaldebnath.github.io/atom.xml" class="nav-link nav-text" target="_blank" rel="noopener">
          <img border="0" alt="RSS" src="/001-rss.png" width="25" height="25"></img>
      </a>
    </div>
  </div>
</div>

                </div>
              </div>
              <!-- Latest Posts Area -->
              <div class="row">
                <div class="col-lg-12">
                  
<div class="card">
  <div class="card-header">
    <b>Latest Posts</b>
  </div>
  <div class="card-block">
    <div class="card-text">
      <ul class="list">
        
          <li>
            <a href="auto-scaling-deep-dive.html">Auto-Scaling Deep Dive</a>
          </li>
        
          <li>
            <a href="journey-from-wordpress-to-hexo-and-clarity.html">Journey from Wordpress to Hexo and Clarity</a>
          </li>
        
          <li>
            <a href="">Oracle Weblogic-as-a-Service for vRealize Automation</a>
          </li>
        
          <li>
            <a href="vmworld-report-from-the-field.html">VMworld report from the field</a>
          </li>
        
          <li>
            <a href="how-to-manually-edit-vrealize-automation-vpostgres-database.html">How to manually edit vRealize Automation vPostgres database</a>
          </li>
        
      </ul>
    </div>
  </div>
</div>

                </div>
              </div>
              <!-- Tags Area -->
              <div class="row">
                <div class="col-lg-12">
                  <div class="card">
  <div class="card-header">
    <b>Post Tags</b>
  </div>
  <div class="card-block">
    <div class="card-text">
      <ul class="list-unstyled">
        <span class="label label-warning">
          <a href="/tags/Automation/">Automation</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/vRealize-Suite">vRealize Suite</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/vRealize-Automation">vRealize Automation</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/vRealize-Operations">vRealize Operations</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/vRealize-Orchestrator">vRealize Orchestrator</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/vRealize-Code-Stream">vRealize Code Stream</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/vRealize-LogInsight">vRealize LogInsight</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/PowerCLI">PowerCLI</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/Python">Python</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/NSX">NSX</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/DevOps">DevOps</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/VSAN">VSAN</a>
        </span>
        <span class="label label-warning">
          <a href="/tags/General">General</a>
        </span>
      </ul>
    </div>
  </div>
</div>

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </clr-main-container>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84051711-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84051711-1');
  gtag('set', {'user_id': 'UA-84051711-1'}); // Set the user ID using signed-in user_id.
</script>

  <!-- Including the Scripts Area -->
  <script src="/js/jquery-3.3.1.slim.min.js" async></script>
  <script>window.jQuery || document.write('<script src="/js/jquery-3.3.1.slim.min.js"><\/script>')</script>

  <noscript>
    Sorry...JavaScript is needed to go ahead.
  </noscript>

  <!-- Defining the scripts -->
  <script type="text/javascript">

    // Handling the main header menubar options in Responsive mode
    $(".header-hamburger-trigger").on('click',function(){
      if($(".main-container").hasClass("open-hamburger-menu")){
        $(".main-container").removeClass("open-hamburger-menu");
      }else{
      $(".main-container").addClass("open-hamburger-menu");
    }
    });

    // Handling the Subnav menubar options in Responsive mode
    $(".header-overflow-trigger").on('click',function(){
      if($(".main-container").hasClass("open-overflow-menu")){
        $(".main-container").removeClass("open-overflow-menu");
      }else{
        $(".main-container").addClass("open-overflow-menu");
      }
    });

  </script>
  <!-- Disqus Comments -->
  
    <script type="text/javascript">
        var disqus_shortname = 'sajaldebnath';
        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>
  

  <script type="text/javascript">

    // The following function provides the active class to header items
    //Separate Section
    // The following two functions creates the dropdown in Subnav

    $(".dropdown").on('click',function(){
      if($(".dropdown").hasClass("open")){
        $(".dropdown").removeClass("open");
        $(this).addClass("open");
      }else{
      $(this).addClass("open");
      }
    });

    // Close the dropdown menu if the user clicks outside of it
    document.onclick = function myClickHandler(event) {
      if (!event.target.matches('.dropdown-toggle')) {
          $(".dropdown").removeClass("open");
      }
    }
  </script>

</body>
</html>
