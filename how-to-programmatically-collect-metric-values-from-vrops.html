
<!DOCTYPE html>
<html lang="en-US">
<!-- Including the Head tag and metadata -->



<head><meta name="generator" content="Hexo 3.8.0">
  <!--Meta-->
    <meta charset="UTF-8">
    <title>How to programmatically collect metric values from vROps-Anything Virtual and Cloudy</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=5.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Here you will find posts on various VMware and other technologies including but not limited to vRealize Suite, NSX, VSAN, PowerCLI, Python, and DevOps. A special focus is on vRA, vROps and vRO">
    <meta name="author" content="Sajal Debnath">
    <link rel="icon" href="/images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/clr-ui.min.css">
    <style>
      .responsive {
        max-width: 100%;
        height: auto;
      }
      .video-container {
        position: relative;
        padding-bottom: 56.25%;
        padding-top: 30px; height: 0; overflow: hidden;
      }
      .video-container iframe,
      .video-container object,
      .video-container embed {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
    </style>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
<!--  <main> body starts from here-->
  <clr-main-container class="main-container">
    <!-- Blog Header Navigation and Subnav menus -->
    
<!-- <header class="header header-4"> -->

<clr-header class="header-6 header">
  <!---->
  <button class="header-hamburger-trigger" type="button" aria-label="HeaderMenu">
    <span></span>
  </button>
  <div class="branding">
      <a class="logo-and-title" href="/">
          <span><img src="/images/Logo.png" alt="Logo" width="36" height="36"></span>
          <span class="title">Anything Virtual and Cloudy</span>
      </a>
  </div>
  <div class="divider"></div>
  <ul class="header-nav list-unstyled clr-nav-level-1">
    <li class="nav-item">
      <a href="/" class="nav-link nav-text">Home</a>
    </li>
      <!---->
      <li class="nav-item">
        <a href="/about/" class="nav-link nav-text">About</a>
      </li>
        <!---->
      <li class="nav-item">
        <a href="/contact/" class="nav-link nav-text">Contact</a>
      </li><li>
      </li><li class="nav-item">
        <a href="/archives/" class="nav-link nav-text">Archives</a>
      </li><li>
  </li></ul>
  <form class="search" action="https://sajaldebnath.github.io/search">
        <label for="search_input">
            <input id="search_input" name="q" type="text" placeholder="Search in the blog">
        </label>
  </form>

</clr-header>


    <!-- Content container starts from here-->
    <!-- Dividing the content area into two different part. First part will Show
      Post and Page related information. Right side will have widgets -->
      

<div class="content-container">
  <div class="content-area">
    <div class="clr-row clr-align-items-start">
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-3">
        <!-- Left side space -->
      </div>
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-6">
        <div class="card">
   <div class="card-header">
      <h3 class="card-title">
        <div class="clr-row clr-align-items-start">
          <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-9 clr-col-xl-9">
            How to programmatically collect metric values from vROps
          </div>
          <!-- Right Side Space -->
          <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-3 clr-col-xl-3 clr-justify-content-end">
            <img border="0" alt="Home" src="/share-solid.svg" width="18" height="18">
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/facebook.svg" width="18" height="18">
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/linkedin.svg" width="18" height="18">
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/twitter.svg" width="18" height="18">
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/google-plus.svg" width="18" height="18">
</a>

            &emsp;
            <a href="/"><img border="0" alt="Home" src="/home-solid.svg" width="18" height="18"></a>
          </div>
        </div>
      </h3>
   </div>
   <div class="card-block">
     
        


Related Categories: <a href="/categories/Virtualization-Cloud/">#Virtualization & Cloud</a> <a href="/categories/Virtualization-Cloud/Monitoring/">#Monitoring</a> &nbsp &nbsp &nbsp &nbsp <img border="0" alt="Info-Standard" src="/calendar-line.svg" width="18" height="18"> 2017-05-17



     
   <div class="card-text">
         <!-- Content -->
      <h4 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h4><p>Few customers inquired about how they can collect metric values directly from vROps. They majorly wanted to get that information using REST API’s. I wrote [another blog post detailing how you can do it]<a href="/learn-all-about-vrops-rest-notifications-and-rest-apis-in-60-minutes.html" title="Learn all about vROps REST notifications and REST APIs in 60 minutes">Learn all about vROps REST notifications and REST APIs in 60 minutes</a>. I wrote a python script to automatically collect metric values from vROps.<br><a id="more"></a><br>This post provides details about that script. Where you can get that script and how it needs to be run.</p>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction:"></a>Introduction:</h4><p>This python script uses the vROps python client to query and gather information directly from vROps server. Its task is to collect metric values from vROps. It uses REST API’s at the backend to get the information. So, to run the script you to download and install Python Client from vROps server. Also, this script was written and tested in Python 2.7 environment. Check my other blog post on details about how you can use python client to interact with vROps server.</p>
<h4 id="Use-Case"><a href="#Use-Case" class="headerlink" title="Use Case:"></a>Use Case:</h4><p>This script will automate the task of collecting metric values directly from vROps for you. You can later use the values as per your requirements.</p>
<h4 id="Where-to-get-it"><a href="#Where-to-get-it" class="headerlink" title="Where to get it?"></a>Where to get it?</h4><p>You can get the script by going to <a href="https://github.com/sajaldebnath/vrops-metric-collection" target="_blank" rel="noopener">GitHub page</a> (<a href="https://github.com/sajaldebnath/vrops-metric-collection)and" target="_blank" rel="noopener">https://github.com/sajaldebnath/vrops-metric-collection)and</a> downloading it from there. There are samples provided in the script.</p>
<h4 id="How-to-run"><a href="#How-to-run" class="headerlink" title="How to run?"></a>How to run?</h4><p>There are two scripts, “<a href="https://github.com/sajaldebnath/vrops-metric-collection/blob/master/metric-collection.py" title="metric-collection.py" target="_blank" rel="noopener">metric-collection.py</a>“ and <a href="https://github.com/sajaldebnath/vrops-metric-collection/blob/master/set-config.py" title="set-config.py" target="_blank" rel="noopener">set-config.py</a>. Download both the scripts in the same location.<br>Run <strong>set-config.py</strong> first. </p>
<pre class=" language-bash"><code class="language-bash">
<span class="token comment" spellcheck="true"># python &lt;localtion to="" file="">/set-config.py </span>
<span class="token operator">&lt;</span>/localtion<span class="token operator">></span></code></pre>

<p>It will set the environment. Then run <strong><em>metric-collection.py</em></strong> to collect the metric values. </p>
<pre class=" language-bash"><code class="language-bash">
<span class="token comment" spellcheck="true"># python &lt;localtion to="" file="">/metric-collection.py</span>
<span class="token operator">&lt;</span>/localtion<span class="token operator">></span></code></pre>

<p>Ideally, you should automate the running of this script using a schedular like cron jobs. Script should not run less than 5 minutes apart. Since vROps collects data every 5 minutes, so running this script less than that time frame will result in redundant data. In this mode “Maximum number of samples to collect” parameter should be left to default value 1. If you want to run the script one time and get as much data as possible (historical), then set the above parameter to the desired value. For example, setting it to 5 will result in getting data from last 5 collections.</p>
<h4 id="How-does-it-collect-metric-values"><a href="#How-does-it-collect-metric-values" class="headerlink" title="How does it collect metric values:"></a>How does it collect metric values:</h4><p>Running <strong>set-config.py</strong> sets up the environment. It will ask for the following information:</p>
<ul>
<li>Adapter Kind</li>
<li>Resource Kind</li>
<li>vROPs server IP/FQDN</li>
<li>user id</li>
<li>vROps password</li>
<li>Maximum number of samples to collect</li>
<li>Number of Keys to Monitor</li>
<li>Keys (one by one)</li>
</ul>
<p>The adapter kind is the adapter for which you want information (e.g, VMware).</p>
<p>The resource kind is the type of resource you want to monitor (e.g., VirtualMachine). </p>
<p>These two parameters are used to filter the results. vROps server and user details are asked to connect to the server. <strong>Maximum number of samples to collect</strong> value is used to determine how many samples we need to collect data for. By default, it is set to 1. </p>
<p>Next is the number of keys to monitor. As the name suggests, this determines the number of keys. The last parameter <strong>Keys</strong> takes the key values one by one. Running the <strong>set-config.py</strong> script stores these values in JSON format in <strong>config.json</strong> file. This file is placed in the same directory. Note, the password is not saved as plain text, it is saved in encrypted format. I agree, probably it is not the best encryption, but at least better than plain text password. </p>
<p>Next run <strong>metric-collection.py</strong>, this script will read the values from config.json file and save the output in JSON format in metric-data.json file. This file is also saved in the same location. Watch the following video for the detailed run and sample output. </p>
<div class="video-container"><iframe src="//www.youtube.com/embed/TWBX-0g_IbM" frameborder="0" allowfullscreen></iframe></div>
<h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h4><p>You can use the script if you want to get the metric values directly from vROps server. I did not test the script extensively. It will be a real help if you can test it out and let me know the outcome. Also, any further suggestions are welcome. I hope this helps you as it helped me.</p>

   </div>
  </div>
     <div class="card-footer">
       <div class="clr-row clr-align-items-start">
         <div class="clr-col-xs-11 clr-col-sm-11 clr-col-md-11 clr-col-lg-11 clr-col-xl-11">
           <b>Share: &emsp; </b>
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/facebook.svg" width="25" height="25">
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/linkedin.svg" width="25" height="25">
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/twitter.svg" width="25" height="25">
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/how-to-programmatically-collect-metric-values-from-vrops.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/google-plus.svg" width="25" height="25">
</a>

         </div>
         <!-- Right Side Space -->
         <div class="clr-col-xs-1 clr-col-sm-1 clr-col-md-1 clr-col-lg-1 clr-col-xl-1 clr-justify-content-end">
           <a href="/"><img border="0" alt="Home" src="/home-solid.svg" width="18" height="18"></a>
         </div>
       </div>
     </div>
</div>
<!-- Comments Section -->

<section class="comments">
  <div class="card">
    <div class="card-header">
      <b>Comments</b>
    </div>
    <div class="card-block">
      <div class="card-text">
        
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>


      </div>
    </div>
  </div>
</section>


      </div>
      <!-- Right Side Space -->
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-3">
      </div>
  </div>
</div>
</div>


  </clr-main-container>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84051711-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84051711-1');
  gtag('set', {'user_id': 'UA-84051711-1'}); // Set the user ID using signed-in user_id.
</script>

  <!-- Including the Scripts Area -->
  <script src="/js/jquery-3.3.1.slim.min.js" async></script>
  <script>window.jQuery || document.write('<script src="/js/jquery-3.3.1.slim.min.js"><\/script>')</script>

  <noscript>
    Sorry...JavaScript is needed to go ahead.
  </noscript>

  <!-- Defining the scripts -->
  <script type="text/javascript">

    // Handling the main header menubar options in Responsive mode
    $(".header-hamburger-trigger").on('click',function(){
      if($(".main-container").hasClass("open-hamburger-menu")){
        $(".main-container").removeClass("open-hamburger-menu");
      }else{
      $(".main-container").addClass("open-hamburger-menu");
    }
    });

    // Handling the Subnav menubar options in Responsive mode
     $(".header-overflow-trigger").on('click',function(){
       if($(".main-container").hasClass("open-overflow-menu")){
         $(".main-container").removeClass("open-overflow-menu");
       }else{
         $(".main-container").addClass("open-overflow-menu");
       }
     });
  </script>
  <!-- Disqus Comments -->
  
    <script type="text/javascript">
        var disqus_shortname = 'sajaldebnath';
        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>
  

</body>
</html>
