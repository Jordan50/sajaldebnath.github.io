
<!DOCTYPE html>
<html lang="en-US">
<!-- Including the Head tag and metadata -->



<head><meta name="generator" content="Hexo 3.8.0">
  <!--Meta-->
    <meta charset="UTF-8">
    <title>Automatically create custom dynamic groups in vROps as per vCenter Tags-Anything Virtual and Cloudy</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=5.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Here you will find posts on various VMware and other technologies including but not limited to vRealize Suite, NSX, VSAN, PowerCLI, Python, and DevOps. A special focus is on vRA, vROps and vRO">
    <meta name="author" content="Sajal Debnath">
    <link rel="icon" href="/images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/clr-ui.min.css">
    <style>
      .responsive {
        max-width: 100%;
        height: auto;
      }
      .video-container {
        position: relative;
        padding-bottom: 56.25%;
        padding-top: 30px; height: 0; overflow: hidden;
      }
      .video-container iframe,
      .video-container object,
      .video-container embed {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
    </style>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
<!--  <main> body starts from here-->
  <clr-main-container class="main-container">
    <!-- Blog Header Navigation and Subnav menus -->
    
<!-- <header class="header header-4"> -->

<clr-header class="header-6 header">
  <!---->
  <button class="header-hamburger-trigger" type="button" aria-label="HeaderMenu">
    <span></span>
  </button>
  <div class="branding">
      <a class="logo-and-title" href="/">
          <span><img src="/images/Logo.png" alt="Logo" width="36" height="36"></span>
          <span class="title">Anything Virtual and Cloudy</span>
      </a>
  </div>
  <div class="divider"></div>
  <ul class="header-nav list-unstyled clr-nav-level-1">
    <li class="nav-item">
      <a href="/" class="nav-link nav-text">Home</a>
    </li>
      <!---->
      <li class="nav-item">
        <a href="/about/" class="nav-link nav-text">About</a>
      </li>
        <!---->
      <li class="nav-item">
        <a href="/contact/" class="nav-link nav-text">Contact</a>
      </li><li>
      </li><li class="nav-item">
        <a href="/archives/" class="nav-link nav-text">Archives</a>
      </li><li>
  </li></ul>
  <form class="search" action="http://localhost:4000/search">
        <label for="search_input">
            <input id="search_input" name="q" type="text" placeholder="Search in the blog">
        </label>
  </form>

</clr-header>


    <!-- Content container starts from here-->
    <!-- Dividing the content area into two different part. First part will Show
      Post and Page related information. Right side will have widgets -->
      

<div class="content-container">
  <div class="content-area">
    <div class="clr-row clr-align-items-start">
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-3">
        <!-- Left side space -->
      </div>
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-6">
        <div class="card">
   <div class="card-header">
      <h3 class="card-title">
        <div class="clr-row clr-align-items-start">
          <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-9 clr-col-xl-9">
            Automatically create custom dynamic groups in vROps as per vCenter Tags
          </div>
          <!-- Right Side Space -->
          <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-3 clr-col-xl-3 clr-justify-content-end">
            <img border="0" alt="Home" src="/share-solid.svg" width="18" height="18">
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/facebook.svg" width="18" height="18">
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/linkedin.svg" width="18" height="18">
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/twitter.svg" width="18" height="18">
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/google-plus.svg" width="18" height="18">
</a>

            &emsp;
            <a href="/"><img border="0" alt="Home" src="/home-solid.svg" width="18" height="18"></a>
          </div>
        </div>
      </h3>
   </div>
   <div class="card-block">
     
        


Related Categories: <a href="/categories/Virtualization-Cloud/">#Virtualization & Cloud</a> <a href="/categories/Virtualization-Cloud/Monitoring/">#Monitoring</a> &nbsp &nbsp &nbsp &nbsp <img border="0" alt="Info-Standard" src="/calendar-line.svg" width="18" height="18"> 2017-06-27



     
   <div class="card-text">
         <!-- Content -->
      <h4 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h4><p>Do you want to create custom dynamic groups in vROps which matches the tags created in vCenter server? You can do this manually, but you have large number of tags created. How to tackle that programmatically? This post covers the exact point. Read on to know how you can automatically create custom dynamic groups in vROps server. These groups will match the tags created in vCenter server.<br><a id="more"></a></p>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction:"></a>Introduction:</h4><p>Last week I got a request from my friend Sunny Dua about a script which will automatically create custom groups in vROps server as per vCenter server tags. This started me thinking. If you have a large environment and you want to keep it organized, then tags in vCenter server is a must. Also creating custom dynamic groups in vROps matching to these vCenter Tags makes sense. So I created scripts to achieve this. Provided below are details of the scripts.</p>
<h4 id="Purpose-of-the-scripts"><a href="#Purpose-of-the-scripts" class="headerlink" title="Purpose of the scripts:"></a>Purpose of the scripts:</h4><p>The purpose of the script is two-fold.</p>
<ul>
<li>First, it should gather the tag names and tag category names from vCenter</li>
<li>Second, it would create custom dynamic groups in vROps server with matches the following criteria’s<ul>
<li>The name of the group is same as the tag names.</li>
<li>Also the membership of the group is dynamic in nature. Those VM’s will be part of a group for which “vSphere Tag” is equal to or contains the tag name/group name</li>
<li>If a “Group Type” is created in vROps server which is</li>
</ul>
</li>
</ul>
<p>So essentially you get custom groups in vROps server with names equal to tag names in vCenter server. The members of the group are the respective VM’s tagged with tagname.</p>
<h4 id="Capabilities-and-limitations"><a href="#Capabilities-and-limitations" class="headerlink" title="Capabilities and limitations:"></a>Capabilities and limitations:</h4><p>Provided below are a list of capabilities of the script:</p>
<p><strong>Data gathering:</strong></p>
<ul>
<li>Default behavior is to return all the tag names and their respective tag category names.</li>
<li>You can specify if you need the tag names of a particular tag category. If you specific the category name then only the tag names belonging to that category will be returned</li>
</ul>
<p><strong>Custom Group Creation:</strong></p>
<p>Create the custom group as per the vCenter tag name</p>
<ul>
<li>The VM’s with the tag names will be part of those custom groups</li>
<li>If “Group Type” is pre-created in vROps server (as per the Tag Category name), then the custom groups will be part of the respective “Group Type”</li>
<li>You can specify the following custom values:<ul>
<li>adapterKind</li>
<li>resourceKind</li>
<li>Properties (with which to match the members)</li>
<li>operator (method of checking, e.g., IS|CONTAINS| IS NOT etc.)</li>
<li>adapterKindkey</li>
<li>create_by_tag_category</li>
</ul>
</li>
</ul>
<p><strong>Provided below are the limitation of the custom group creation</strong> In vROps server we can have two different custom dynamic groups with the same name, provided they are part of different “Group Type”. The script currently checks for duplicate custom group name but does not check for the Group type. So you will not be able to create two custom dynamic groups with same name in any way. To do: If a match for custom group name found then further check for the Group Type field.</p>
<h4 id="Required-environment"><a href="#Required-environment" class="headerlink" title="Required environment:"></a>Required environment:</h4><p>I tested the scripts in the following environment.</p>
<ul>
<li>vCenter Server 6.0 U3</li>
<li>vROps server 6.6</li>
<li>PowerCLI 6.5 R1</li>
<li>PowerShel 5.0</li>
<li>Python 2.7.x</li>
</ul>
<p>To run the script you would need Nagini module (python client) for vROps REST API. Please <a href="http://www.vrandom.com/vrops/python-api/" target="_blank" rel="noopener">check this blog</a> for details on how you can download and use this module.</p>
<h4 id="Acknowledgement"><a href="#Acknowledgement" class="headerlink" title="Acknowledgement:"></a>Acknowledgement:</h4><p>Before I start writing this blog I need to say thanks to few people.</p>
<ul>
<li>To save time, for data gathering, I used the <a href="https://blogs.vmware.com/PowerCLI/2014/03/using-vsphere-tags-powercli.html" target="_blank" rel="noopener">ExportImportTags.ps1 given here</a> (originally created by <strong>Dimitar Barfonchovski</strong>). It is a small and simple script and I made many changes to the original script (removed the import portion and exported data in JSON format in place or original XML format). Instead of saving the entire data, I am saving a subset of it.</li>
<li>My friend <strong>Vinith Menon</strong> already written a script similar to this. His original blog was further re-created by <strong>John Dias.</strong> You can find <a href="https://blogs.vmware.com/management/2017/03/access-internal-rest-apis-in-vr-ops-with-powershell.html" target="_blank" rel="noopener">details here</a>. Vinith written the script in PowerShell.</li>
</ul>
<h4 id="Why-similar-script-for-creating-custom-dynamic-groups"><a href="#Why-similar-script-for-creating-custom-dynamic-groups" class="headerlink" title="Why similar script for creating custom dynamic groups?"></a>Why similar script for creating custom dynamic groups?</h4><p>Question is, why I wrote script which does the similar task for which Vinith Menon already had a script? Provided below are my reasons:</p>
<ul>
<li>Vinith mainly showed how you can access vROps internal REST API’s to create custom groups. My script provides a more complete solution.</li>
<li>I always stressed that when it comes to vROps REST API, python is a far more cleaner and easier way to do it.</li>
</ul>
<p>Note, in PowerShell way you will actually have to do the bare bone Invoke-RestMethod. Python already handles those for you. Just call the methods and you are good.</p>
<h4 id="Where-to-get-the-scripts-and-what-is-included"><a href="#Where-to-get-the-scripts-and-what-is-included" class="headerlink" title="Where to get the scripts and what is included?"></a>Where to get the scripts and what is included?</h4><p>I have created a <a href="https://github.com/sajaldebnath/vrops-custom-group-creation/" target="_blank" rel="noopener">GitHub repository</a> from where you can download the scripts.   The following scripts are available:</p>
<ul>
<li><p>create-custom-group-vrops.py</p>
</li>
<li><p>Get-TagNames.ps1</p>
</li>
<li><p>set-env.py</p>
</li>
</ul>
<h4 id="How-to-run-the-scripts"><a href="#How-to-run-the-scripts" class="headerlink" title="How to run the scripts?"></a>How to run the scripts?</h4><p>Download the scripts and store them in the same folder.</p>
<p>First you need to run the Get-TagNames.ps1 script. Follow the following process to run the script. I am assuming you are running the script from VMware PowerCLI console. Note, I am dot sourcing [.] the <strong>Get-TagNames.ps1</strong> script so that the function defined in it is available in the environment.</p>
<pre class=" language-powershell"><code class="language-powershell">
<span class="token function">PS</span>:> <span class="token variable">$server</span> = Connect<span class="token operator">-</span>VIserver <span class="token operator">-</span>Server &lt;vcenter server=<span class="token string">""</span> ip=<span class="token string">""</span> fqdn=<span class="token string">""</span>>
<span class="token function">PS</span>:> <span class="token punctuation">.</span> <span class="token punctuation">.</span>\Get<span class="token operator">-</span>TagNames<span class="token punctuation">.</span>ps1   
<span class="token function">PS</span>:> Export<span class="token operator">-</span>Tag <span class="token operator">-</span>Server <span class="token variable">$server</span> <span class="token punctuation">[</span><span class="token operator">-</span>Category &lt;tag<span class="token operator">-</span>category<span class="token operator">-</span>name><span class="token punctuation">]</span>
&lt;<span class="token operator">/</span>tag<span class="token operator">-</span>category<span class="token operator">-</span>name>&lt;<span class="token operator">/</span>vcenter></code></pre>

<p>Note, the <strong>-Category</strong> option is optional. If specified, script will get the tag names from that tag category only.</p>
<p>Running the script will generate a “taglist.json” file which has the data (tagName and categoryName).</p>
<p>Next run, python scripts from command prompt:</p>
<pre class=" language-console"><code class="language-console">
C:\> python set-env.py
</code></pre>

<p>This will ask inputs for configuring the environment and will generate a “env.json” file which will have the environment information to be used later.</p>
<p>Next run:</p>
<pre class=" language-console"><code class="language-console">
C:\> python create-custom-group-vrops.py
</code></pre>

<p>This will create the custom groups in vROps server. Watch the video for further explanation of the scripts and run-time information.</p>
<div class="video-container"><iframe src="//www.youtube.com/embed/lST9G2qUiX4" frameborder="0" allowfullscreen></iframe></div>
<h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h4><p>You can use the script to dynamically create dynamic groups in vROps inline with the vCenter Serer tags .</p>

   </div>
  </div>
     <div class="card-footer">
       <div class="clr-row clr-align-items-start">
         <div class="clr-col-xs-11 clr-col-sm-11 clr-col-md-11 clr-col-lg-11 clr-col-xl-11">
           <b>Share: &emsp; </b>
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/facebook.svg" width="25" height="25">
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/linkedin.svg" width="25" height="25">
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/twitter.svg" width="25" height="25">
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/automatically-create-custom-dynamic-groups-in-vrops-as-per-vcenter-tags.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/google-plus.svg" width="25" height="25">
</a>

         </div>
         <!-- Right Side Space -->
         <div class="clr-col-xs-1 clr-col-sm-1 clr-col-md-1 clr-col-lg-1 clr-col-xl-1 clr-justify-content-end">
           <a href="/"><img border="0" alt="Home" src="/home-solid.svg" width="18" height="18"></a>
         </div>
       </div>
     </div>
</div>
<!-- Comments Section -->

<section class="comments">
  <div class="card">
    <div class="card-header">
      <b>Comments</b>
    </div>
    <div class="card-block">
      <div class="card-text">
        
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>


      </div>
    </div>
  </div>
</section>


      </div>
      <!-- Right Side Space -->
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-3">
      </div>
  </div>
</div>
</div>


  </clr-main-container>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84051711-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84051711-1');
  gtag('set', {'user_id': 'UA-84051711-1'}); // Set the user ID using signed-in user_id.
</script>

  <!-- Including the Scripts Area -->
  <script src="/js/jquery-3.3.1.slim.min.js" async></script>
  <script>window.jQuery || document.write('<script src="/js/jquery-3.3.1.slim.min.js"><\/script>')</script>

  <noscript>
    Sorry...JavaScript is needed to go ahead.
  </noscript>

  <!-- Defining the scripts -->
  <script type="text/javascript">

    // Handling the main header menubar options in Responsive mode
    $(".header-hamburger-trigger").on('click',function(){
      if($(".main-container").hasClass("open-hamburger-menu")){
        $(".main-container").removeClass("open-hamburger-menu");
      }else{
      $(".main-container").addClass("open-hamburger-menu");
    }
    });

    // Handling the Subnav menubar options in Responsive mode
     $(".header-overflow-trigger").on('click',function(){
       if($(".main-container").hasClass("open-overflow-menu")){
         $(".main-container").removeClass("open-overflow-menu");
       }else{
         $(".main-container").addClass("open-overflow-menu");
       }
     });
  </script>
  <!-- Disqus Comments -->
  
    <script type="text/javascript">
        var disqus_shortname = 'sajaldebnath';
        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>
  

</body>
</html>
