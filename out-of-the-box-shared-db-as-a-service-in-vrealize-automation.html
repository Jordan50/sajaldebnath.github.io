
<!DOCTYPE html>
<html lang="en-US">
<!-- Including the Head tag and metadata -->



<head><meta name="generator" content="Hexo 3.8.0">
  <!--Meta-->
    <meta charset="UTF-8">
    <title>Out-of-the-box shared DB-as-a-Service in vRealize Automation-Anything Virtual and Cloudy</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=5.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Here you will find posts on various VMware and other technologies including but not limited to vRealize Suite, NSX, VSAN, PowerCLI, Python, and DevOps. A special focus is on vRA, vROps and vRO">
    <meta name="author" content="Sajal Debnath">
    <link rel="icon" href="/images/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="/css/clr-ui.min.css">
    <style>
      .responsive {
        max-width: 100%;
        height: auto;
      }
      .video-container {
        position: relative;
        padding-bottom: 56.25%;
        padding-top: 30px; height: 0; overflow: hidden;
      }
      .video-container iframe,
      .video-container object,
      .video-container embed {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
    </style>
<link rel="stylesheet" href="/css/prism.css" type="text/css"></head>


<body>
<!--  <main> body starts from here-->
  <clr-main-container class="main-container">
    <!-- Blog Header Navigation and Subnav menus -->
    
<!-- <header class="header header-4"> -->

<clr-header class="header-6 header">
  <!---->
  <button class="header-hamburger-trigger" type="button" aria-label="HeaderMenu">
    <span></span>
  </button>
  <div class="branding">
      <a class="logo-and-title" href="/">
          <span><img src="/images/Logo.png" alt="Logo" width="36" height="36"></span>
          <span class="title">Anything Virtual and Cloudy</span>
      </a>
  </div>
  <div class="divider"></div>
  <ul class="header-nav list-unstyled clr-nav-level-1">
    <li class="nav-item">
      <a href="/" class="nav-link nav-text">Home</a>
    </li>
      <!---->
      <li class="nav-item">
        <a href="/about/" class="nav-link nav-text">About</a>
      </li>
        <!---->
      <li class="nav-item">
        <a href="/contact/" class="nav-link nav-text">Contact</a>
      </li><li>
      </li><li class="nav-item">
        <a href="/archives/" class="nav-link nav-text">Archives</a>
      </li><li>
  </li></ul>
  <form class="search" action="http://localhost:4000/search">
        <label for="search_input">
            <input id="search_input" name="q" type="text" placeholder="Search in the blog">
        </label>
  </form>

</clr-header>


    <!-- Content container starts from here-->
    <!-- Dividing the content area into two different part. First part will Show
      Post and Page related information. Right side will have widgets -->
      

<div class="content-container">
  <div class="content-area">
    <div class="clr-row clr-align-items-start">
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-3">
        <!-- Left side space -->
      </div>
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-6">
        <div class="card">
   <div class="card-header">
      <h3 class="card-title">
        <div class="clr-row clr-align-items-start">
          <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-9 clr-col-xl-9">
            Out-of-the-box shared DB-as-a-Service in vRealize Automation
          </div>
          <!-- Right Side Space -->
          <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-3 clr-col-xl-3 clr-justify-content-end">
            <img border="0" alt="Home" src="/share-solid.svg" width="18" height="18">
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/facebook.svg" width="18" height="18">
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/linkedin.svg" width="18" height="18">
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/twitter.svg" width="18" height="18">
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/google-plus.svg" width="18" height="18">
</a>

            &emsp;
            <a href="/"><img border="0" alt="Home" src="/home-solid.svg" width="18" height="18"></a>
          </div>
        </div>
      </h3>
   </div>
   <div class="card-block">
     
        


Related Categories: <a href="/categories/Virtualization-Cloud/">#Virtualization & Cloud</a> <a href="/categories/Virtualization-Cloud/Automation/">#Automation</a> &nbsp &nbsp &nbsp &nbsp <img border="0" alt="Info-Standard" src="/calendar-line.svg" width="18" height="18"> 2017-07-23



     
   <div class="card-text">
         <!-- Content -->
      <h4 id="Purpose"><a href="#Purpose" class="headerlink" title="Purpose"></a>Purpose</h4><p>This blog post provides details of shared DB-as-a-Service capability in vRealize Automation. This functionality provided by vRO workflows. A vRO package was created and is available here. Details of the required tools and configuration steps are also provided. Also, the repository details of the package given.<br><a id="more"></a></p>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction:"></a>Introduction:</h3><p>In last few months, I got many requests for shared DB-as-a-Service for private cloud. Specifically, the private clouds built with <a href="https://www.vmware.com/in/products/vrealize-automation.html" target="_blank" rel="noopener">VMware</a> vRealize Automation. Considering this, I decided to create a vRealize Orchestrator package for this purpose. This will provide such capability out-of-the box in vRA. Import the package, run a single workflow, provide the inputs. The services published in vRA Catalog. Any consumer requiring such service can request the items from Catalog. As of now, this package supports three different types of databases, MSSQL, PostgreSQL and MySQL.</p>
<h4 id="Why-Shared-DB-as-a-Service"><a href="#Why-Shared-DB-as-a-Service" class="headerlink" title="Why Shared DB-as-a-Service:"></a>Why Shared DB-as-a-Service:</h4><p>I want to cover a little background before going into details of the package contents. A dedicated database server is generally used for a production environment or for heavy workloads. For development or for testing we do not need a dedicated database server. The Same policy applies to milder workloads as well. For these use cases, we need a shared database server. Here we create a database instance on the same database server and consume it as per our need.</p>
<p>With the rise of Cloud services, shared DB-as-a-Service became very popular.  There, Database instances created and consumed as and when required. This post gives details of the vRO package which provides this exact functionality. This package used in vRealize Automation environment to provide shared DB-as-a-Service.</p>
<h4 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works:"></a>How it works:</h4><p>First, download and import the vRealize Orchestrator package “com.vmware.db-as-a-service.package”. After import, as an admin, run the main workflow “Setup Database-as-a-Service Environment”. This workflow will set the environment. The workflow asks for the inputs and sets the environment. It publishes Catalog items. End users request for the item and get the services. Users provide details of user name, password and db name to create the databases.</p>
<h4 id="Required-environment"><a href="#Required-environment" class="headerlink" title="Required environment:"></a>Required environment:</h4><p>Provided below are the environmental details.</p>
<ul>
<li><p>vCenter Server 6.5</p>
</li>
<li><p>vRealize Automation Server 7.3</p>
</li>
<li><p>vRealize Orchestrator 7.3</p>
</li>
</ul>
<p><strong>Database versions.</strong></p>
<ul>
<li><p>PostgreSQL 9.4</p>
</li>
<li><p>MySQL 5.7.18</p>
</li>
<li><p>MSSQL 2014</p>
</li>
</ul>
<p><strong>VMware Environmental setup:</strong></p>
<ul>
<li><p>vRealize Orchestrator should have the following configuration</p>
</li>
<li><p>vCenter Server registered as an endpoint in vRO</p>
</li>
<li><p>Registered vRealize Automation Appliance (VAMI/CAFE APPLIANCE)</p>
</li>
<li><p>Registered IaaS server</p>
</li>
<li><p>A configured vRA environment (For details on how to configure check <a href="https://docs.vmware.com/en/vRealize-Automation/index.html" target="_blank" rel="noopener">this link</a>)</p>
</li>
</ul>
<p><strong>Database Environmental Setup:</strong></p>
<ul>
<li><p>A working PostgreSQL server</p>
</li>
<li><p>Remote connection configured in PostgreSQL server</p>
</li>
<li><p>Configured MySQL server</p>
</li>
<li><p>Local root login enabled in MySQL server. Configured passwordless root login. For security, you can configure password (in that case, change the original workflow)</p>
</li>
<li><p>MSSQL server installed and configured</p>
</li>
</ul>
<p> <strong>MSSQL Server:</strong></p>
<ul>
<li>Mixed mode or windows mode authentication is needed</li>
<li>The domain user which has access to the VM (runs the PowerShell script) should have admin access to the database to be able to create and delete databases and users.</li>
</ul>
<p>You can change the configurations as per your need. Let me know what modifications you need and I will incorporate them.</p>
<p>Also, configuring all three of the databases is not mandatory. If you have only one database environment, configure that and the rest skipped.</p>
<h4 id="Package-source-and-details"><a href="#Package-source-and-details" class="headerlink" title="Package source and details:"></a>Package source and details:</h4><p>I have created a <a href="https://github.com/sajaldebnath/shared-db-as-a-service" target="_blank" rel="noopener">GitHub repository</a> from where you can download the package. The package name is “com.vmware.db-as-a-service.package”. The package will create a folder “Database-as-a-Service” under the main workflow window. It also has “Helper Workflows”, “Database Creation Workflows” and “Environment Setup Workflows” folders. All these under this main “Database-as-a-Service” folder. The “Environment Setup Workflows” contains the workflows related to setting up the environment. The “Database Creation Workflows” contains the workflows which create the actual databases. “Helper Workflows” folder contains workflows to set and get the environment details.</p>
<p><img src="/images/2017/07/Folder-Structure.png" alt="Folder Structure for shared DB-as-a-Service" class="responsive"></p>
<p>The package contains other related workflows, actions, and resource items.</p>
<h4 id="How-to-run-the-workflows"><a href="#How-to-run-the-workflows" class="headerlink" title="How to run the workflows?"></a>How to run the workflows?</h4><p>The first thing to do is to setup the environment. So login to vRO server, import the package. Next, as an administrator run the “Setup Database-as-a-Service Environment” workflow. This will ask for the following inputs:</p>
<ul>
<li><p>vRA Cafe Appliance</p>
</li>
<li><p>Service to which to add the catalog items</p>
</li>
<li><p>Entitlement where to add the catalog items</p>
</li>
<li><p>Approval Policies (if any)</p>
</li>
</ul>
<p>Next three pages ask the database server details. Select the database server VM. Provide user name and password for the database VM’s. This will create and publish three different catalog items:</p>
<ul>
<li><p>MSSQL DB-as-a-Service</p>
</li>
<li><p>MySQL DB-as-a-Service</p>
</li>
<li><p>PostgreSQL DB-as-a-Service</p>
</li>
</ul>
<h4 id="Update"><a href="#Update" class="headerlink" title="Update:"></a><strong>Update:</strong></h4><p>Please note, the earlier version of the package only catered to the default instance of an MSSQL server (thanks Rawlinson Rivera for pointing this out). In the updated version, the MSSQL server database creation considers the named instances as well.</p>
<p>So for the MSSQL server provide the following added information:</p>
<p><strong>Default Instance:</strong> Whether default instance is used to DB creation. Please note, the default instance is typical “MSSQLSERVER” or “SQLExpress”. If at the time of installing the database, default instance name was selected then this should be “yes”. Otherwise “no” should be typed in.</p>
<p>Also note, please type in only “yes” or “no”. Currently, I have not provided any input validation here.</p>
<p><strong>Instance Name:</strong> Provide the instance name in which DB to be created. This is typically the named instance. Note, if this is the only instance on the server, still if the default name was not selected, then provide this value here.</p>
<p>All set, now end users can request the catalog items and get respective databases. They need to provide required inputs. The inputs required are </p>
<ul>
<li><p>User Name</p>
</li>
<li><p>Password</p>
</li>
<li><p>Database Name</p>
</li>
</ul>
<p>The workflows create a user in the database server. The password for the user is the one user provided. Also, a database created with the provided name. The created user is the owner of the database.</p>
<p><strong>Please watch the following video to see details and working of the service.</strong></p>
<div class="video-container"><iframe src="//www.youtube.com/embed/CSZGpqqcNHI" frameborder="0" allowfullscreen></iframe></div>
<h4 id="Acknowledgement"><a href="#Acknowledgement" class="headerlink" title="Acknowledgement:"></a>Acknowledgement:</h4><p>This solution was based on work done by Christophe Decanini. I used the modified package available at <a href="https://code.vmware.com/samples/1151/guest-script-manager-package-for-vro-7-orginally-created-by-cdecanini-?h=vRealize%20Orchestrator" target="_blank" rel="noopener">this link</a>. The core logic uses the workflows created and described by his. So full credit goes to Christophe for this wonderful package.</p>
<h4 id="To-do"><a href="#To-do" class="headerlink" title="To do:"></a>To do:</h4><ul>
<li>Workflows for Deletion of an existing database.</li>
<li>To implement Error checking</li>
<li>Thorugh stability testing</li>
</ul>
<h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h4><p>You can use the package and associated workflows to provide shared DB-as-a-Service in vRealize Automation environment. At this stage, the workflows are for PoC environment only. Though the workflows were tested for performance, not all use cases were covered nor diligent error checking was done. Till then please go ahead use it and let me know your feedbacks. Do let me know if you need more modifications or something else.</p>

   </div>
  </div>
     <div class="card-footer">
       <div class="clr-row clr-align-items-start">
         <div class="clr-col-xs-11 clr-col-sm-11 clr-col-md-11 clr-col-lg-11 clr-col-xl-11">
           <b>Share: &emsp; </b>
<a class="card-link" href="http://www.facebook.com/sharer.php?u=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Facebook" src="/facebook.svg" width="25" height="25">
</a>
<a class="card-link" href="http://www.linkedin.com/shareArticle?mini=true&url=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="LinkedIn" src="/linkedin.svg" width="25" height="25">
</a>
<a class="card-link" href="http://twitter.com/intent/tweet?text=An%20intersting%20blog&url=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Twitter" src="/twitter.svg" width="25" height="25">
</a>
<a class="card-link" href="https://plus.google.com/share?url=https://sajaldebnath.com/out-of-the-box-shared-db-as-a-service-in-vrealize-automation.html" onclick="javascript:window.open(this.href,'', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
  <img border="0" alt="Goolge+" src="/google-plus.svg" width="25" height="25">
</a>

         </div>
         <!-- Right Side Space -->
         <div class="clr-col-xs-1 clr-col-sm-1 clr-col-md-1 clr-col-lg-1 clr-col-xl-1 clr-justify-content-end">
           <a href="/"><img border="0" alt="Home" src="/home-solid.svg" width="18" height="18"></a>
         </div>
       </div>
     </div>
</div>
<!-- Comments Section -->

<section class="comments">
  <div class="card">
    <div class="card-header">
      <b>Comments</b>
    </div>
    <div class="card-block">
      <div class="card-text">
        
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>


      </div>
    </div>
  </div>
</section>


      </div>
      <!-- Right Side Space -->
      <div class="clr-col-xs-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-12 clr-col-xl-3">
      </div>
  </div>
</div>
</div>


  </clr-main-container>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-84051711-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-84051711-1');
  gtag('set', {'user_id': 'UA-84051711-1'}); // Set the user ID using signed-in user_id.
</script>

  <!-- Including the Scripts Area -->
  <script src="/js/jquery-3.3.1.slim.min.js" async></script>
  <script>window.jQuery || document.write('<script src="/js/jquery-3.3.1.slim.min.js"><\/script>')</script>

  <noscript>
    Sorry...JavaScript is needed to go ahead.
  </noscript>

  <!-- Defining the scripts -->
  <script type="text/javascript">

    // Handling the main header menubar options in Responsive mode
    $(".header-hamburger-trigger").on('click',function(){
      if($(".main-container").hasClass("open-hamburger-menu")){
        $(".main-container").removeClass("open-hamburger-menu");
      }else{
      $(".main-container").addClass("open-hamburger-menu");
    }
    });

    // Handling the Subnav menubar options in Responsive mode
     $(".header-overflow-trigger").on('click',function(){
       if($(".main-container").hasClass("open-overflow-menu")){
         $(".main-container").removeClass("open-overflow-menu");
       }else{
         $(".main-container").addClass("open-overflow-menu");
       }
     });
  </script>
  <!-- Disqus Comments -->
  
    <script type="text/javascript">
        var disqus_shortname = 'sajaldebnath';
        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>
  

</body>
</html>
